<%- include('partials/header') %>
    <!-- Title Bar -->
    <div class="pbmit-title-bar-wrapper">
        <div class="container">
            <div class="pbmit-title-bar-content">
                <div class="pbmit-title-bar-content-inner">
                    <div class="pbmit-tbar">
                        <div class="pbmit-tbar-inner container">
                            <h1 class="pbmit-tbar-title"> Our Products</h1>
                        </div>
                    </div>
                    <div class="pbmit-breadcrumb">
                        <div class="pbmit-breadcrumb-inner">
                            <span>
                                <a title="" href="#" class="home"><span>Yral Concepts</span></a>
                            </span>
                            <span class="sep">
                                <i class="pbmit-base-icon-angle-right"></i>
                            </span>
                            <span>
                                <a title="" href="#" class="home"><span>Products</span></a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Title Bar End-->
    <section class="site-content service-details">
        <div class="container">
            <div class="row">
                <div class="col-md-12 col-xl-9 service-left-col">
                    <div class="container">
                        <div class="pbmit-element-posts-wrapper row">
                            <% if (products.length === 0) { %>
                               <div class="no-data">
                                <h6>No products found!</h6>
                               </div>
                                <% } %>
                                
                            <% if (products && products.length) { %>
                                <% products.forEach(function(product, index) { %>
                                    <article class="pbmit-service-style-1 col-md-4">
                                        <div class="pbminfotech-post-item">
                                            <div class="pbmit-box-content-wrap">
                                                <div class="pbmit-service-image-wrapper">
                                                    <div class="pbmit-featured-img-wrapper">
                                                        <div class="pbmit-featured-wrapper">
                                                            <img src="<%= product?.image %>" class="img-fluid" alt="">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="pbmit-content-box">
                                                    <h3 class="pbmit-service-title">
                                                        <%= product.title %>
                                                    </h3>
                                                    <div class="buy__now">
                                                        <div class="pbmit-button transform-bottom transform-delay-4">
                                                            <a class="pbmit-btn pbmit-btn-global whatsapp-link-<%= index %>" target="_blank"
                                                                href="https://wa.me/562024262?text=*PRODUCT%20ENQUIRY*%0A---------------------------%0AProduct%20Name%20:%20<%= encodeURIComponent(product.title) %>%0AQuantity%20:%201%0AImage%20URL:%20<%= encodeURIComponent(IMAGE_URL+ product.image) %>">
                                                                <span class="pbmit-button-content-wrapper">
                                                                    <span class="pbmit-button-icon">
                                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                                            width="22.76" height="22.76"
                                                                            viewBox="0 0 22.76 22.76">
                                                                            <title>black-arrow</title>
                                                                            <path
                                                                                d="M22.34,1A14.67,14.67,0,0,1,12,5.3,14.6,14.6,0,0,1,6.08,4.06,14.68,14.68,0,0,1,1.59,1"
                                                                                transform="translate(-0.29 -0.29)"
                                                                                fill="none" stroke="#000"
                                                                                stroke-width="2"></path>
                                                                            </path>
                                                                            <path d="M22.34,1a14.67,14.67,0,0,0,0,20.75"
                                                                                transform="translate(-0.29 -0.29)"
                                                                                fill="none" stroke="#000"
                                                                                stroke-width="2">
                                                                            </path>
                                                                            <path d="M22.34,1,1,22.34"
                                                                                transform="translate(-0.29 -0.29)"
                                                                                fill="none" stroke="#000"
                                                                                stroke-width="2">
                                                                            </path>
                                                                        </svg>
                                                                    </span>
                                                                    <span class="pbmit-button-text">Buy Now</span>
                                                                </span>
                                                            </a>
                                                        </div>
                                                        <div class="counter">
                                                            <button class="decrease-btn" data-index="<%= index %>" disabled style="font-size: 14px;">&minus;</button>
                                                            <span class="count-display" data-index="<%= index %>">1</span>
                                                            <button class="increase-btn" data-index="<%= index %>"><i
                                                                    class="pbmit-base-icon-plus"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </article>
                                <% }) %>
                            <% } %>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 col-xl-3 service-right-col sidebar">
                    <aside class="service-sidebar">
                        <aside class="widget post-list">
                            <h2 class="widget-title">Categories</h2>
                            <div class="all-post-list">
                                <ul>
                                    <li class="<%= !selectedCategory ? 'post-active' : '' %>">
                                        <a href="/products">All</a>
                                    </li>
                                    <% categories.forEach(function(cat) { %>
                                        <li class="<%= selectedCategory === cat.title ? 'post-active' : '' %>">
                                            <a href="/products?category=<%= encodeURIComponent(cat.title) %>">
                                                <%= cat.title %>
                                            </a>
                                        </li>
                                        <% }) %>
                                </ul>
                            </div>
                        </aside>
                        <!-- <aside class="widget post-list">
                        <h2 class="widget-title">Brands</h2>
                        <div class="all-post-list">
                            <ul>
                                <li><a href="#">Hygia</a></li>
                                <li><a href="#">Bio Solve</a></li>
                                <li><a href="#">Ekota</a></li>
                                <li><a href="#">Izzah</a></li>
                            </ul>
                        </div>
                    </aside> -->
                        <aside class="widget pbmit-service-ad">
                            <div class="textwidget">
                                <div class="pbmit-service-ads">
                                    <div class="pbmit-ads-call">Call +971 56 202 4262</div>
                                    <h4 class="pbmit-ads-subtitle">We Provide</h4>
                                    <h3 class="pbmit-ads-title">Best Services</h3>
                                    <a class="pbmit-btn pbmit-btn-global" href="/contact">
                                        <span class="pbmit-button-content-wrapper">
                                            <span class="pbmit-button-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="22.76" height="22.76"
                                                    viewBox="0 0 22.76 22.76">
                                                    <title>black-arrow</title>
                                                    <path
                                                        d="M22.34,1A14.67,14.67,0,0,1,12,5.3,14.6,14.6,0,0,1,6.08,4.06,14.68,14.68,0,0,1,1.59,1"
                                                        transform="translate(-0.29 -0.29)" fill="none" stroke="#000"
                                                        stroke-width="2"></path>
                                                    <path d="M22.34,1a14.67,14.67,0,0,0,0,20.75"
                                                        transform="translate(-0.29 -0.29)" fill="none" stroke="#000"
                                                        stroke-width="2"></path>
                                                    <path d="M22.34,1,1,22.34" transform="translate(-0.29 -0.29)"
                                                        fill="none" stroke="#000" stroke-width="2"></path>
                                                </svg>
                                            </span>
                                            <span class="pbmit-button-text">Contact us Now</span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                        </aside>
                        <aside class="widget pbmit-download-info">
                            <h2 class="widget-title">Company profile</h2>
                            <div class="textwidget">
                                <div class="pbmit-download">
                                    <div class="pbmit-item-download">
                                        <a href="/assets/brochure.pdf" target="_blank" rel="noopener">
                                            <div class="pbmit-download-content">
                                                <div class="pbmit-download-wrap">
                                                    <i class="pbmit-base-icon-pdf"></i>
                                                    <div class="pbmit-title-wrap">
                                                        <h3 class="pbmit-download-title">Download PDF File</h3>
                                                        <span>Brouchers</span>
                                                    </div>
                                                </div>
                                                <span class="pbmit-download-item">
                                                    <i
                                                        class="pbminfotech-base-icons pbmit-righticon pbmit-base-icon-download"></i>
                                                </span>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </aside>
                    </aside>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get all counter elements
            const decreaseBtns = document.querySelectorAll('.decrease-btn');
            const increaseBtns = document.querySelectorAll('.increase-btn');
            const countDisplays = document.querySelectorAll('.count-display');
            
            // Store counts for each product
            const counts = {};
            
            // Initialize counts
            countDisplays.forEach(display => {
                const index = display.getAttribute('data-index');
                counts[index] = 1;
            });
            
            // Set up increase button handlers
            increaseBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const index = btn.getAttribute('data-index');
                    counts[index]++;
                    
                    // Update display
                    const display = document.querySelector(`.count-display[data-index="${index}"]`);
                    display.textContent = counts[index];
                    
                    // Enable decrease button
                    const decreaseBtn = document.querySelector(`.decrease-btn[data-index="${index}"]`);
                    decreaseBtn.disabled = false;
                    
                    // Update WhatsApp link
                    updateWhatsAppLink(index, counts[index]);
                });
            });
            
            // Set up decrease button handlers
            decreaseBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const index = btn.getAttribute('data-index');
                    
                    if (counts[index] > 1) {
                        counts[index]--;
                        
                        // Update display
                        const display = document.querySelector(`.count-display[data-index="${index}"]`);
                        display.textContent = counts[index];
                        
                        // Disable decrease button if count is 1
                        btn.disabled = counts[index] === 1;
                        
                        // Update WhatsApp link
                        updateWhatsAppLink(index, counts[index]);
                    }
                });
            });
            
            // Function to update WhatsApp link with current count
            function updateWhatsAppLink(index, count) {
                const link = document.querySelector(`.whatsapp-link-${index}`);
                if (link) {
                    const href = link.getAttribute('href');
                    // Replace the quantity in the URL
                    const newHref = href.replace(/Quantity%20:%20\d+/, `Quantity%20:%20${count}`);
                    link.setAttribute('href', newHref);
                }
            }
        });
        </script>

    <%- include('partials/footer') %>